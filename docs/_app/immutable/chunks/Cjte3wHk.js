import{d as p}from"./gAR7uIZd.js";import{q as h}from"./PJW6Ty7q.js";function E(e,t,r,s){var c=e.__style;if(h||c!==t){var o=p(t);(!h||o!==e.getAttribute("style"))&&(o==null?e.removeAttribute("style"):e.style.cssText=o),e.__style=t}return s}const u="https://docs.google.com/spreadsheets/d/e/2PACX-1vRS8H-swB-iWOqUboB_WynsaJaQgPdpfde28vCciioq98LWSytyFR0UVnd6G8sOR9EMCB7EZ1vb7qwm/pub?gid=0&single=true&output=csv",f="prime_stories_cache",g=3600*1e3;function d(e){const t=e.trim().split(`
`);t[0].split(",").map(a=>a.replace(/"/g,"").trim());const r=[];let s=[],c=!1,o="";for(let a=1;a<t.length;a++){const l=t[a];s=[],o="",c=!1;for(let n=0;n<l.length;n++){const i=l[n];i==='"'?c&&l[n+1]==='"'?(o+='"',n++):c=!c:i===","&&!c?(s.push(o.trim()),o=""):o+=i}if(s.push(o.trim()),s.length>=2){const n=s[0].replace(/"/g,"").trim(),i=s[1].replace(/"/g,"").trim();n&&r.push({story:n,name:i||null,id:Math.random().toString(36).substr(2,9)})}}return r}async function w(){try{const e=localStorage.getItem(f);if(e){const{data:t,timestamp:r}=JSON.parse(e);if(!(Date.now()-r>g)&&t&&t.length>0)return t}}catch(e){console.warn("Error reading from cache:",e)}try{const e=await fetch(u);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const t=await e.text(),r=d(t);try{localStorage.setItem(f,JSON.stringify({data:r,timestamp:Date.now()}))}catch(s){console.warn("Error saving to cache:",s)}return r}catch(e){console.error("Error fetching stories:",e);try{const t=localStorage.getItem(f);if(t){const{data:r}=JSON.parse(t);if(r&&r.length>0)return console.warn("Using expired cached data due to fetch error"),r}}catch(t){console.error("Error reading expired cache:",t)}return[]}}function S(e){const t=[...e];for(let r=t.length-1;r>0;r--){const s=Math.floor(Math.random()*(r+1));[t[r],t[s]]=[t[s],t[r]]}return t}export{E as a,w as l,S as s};
