import{q as _,aF as F,aG as G,aH as q,aI as z,aJ as B,d as J,p as j,g as P,k as D,u as S,o as K,f as U,c as m,t as V,a as A,b as Y,h as $,i as b,j as h,r as w}from"./PJW6Ty7q.js";import"./DF2TzUtJ.js";import{p as M,i as Q,b as W}from"./DX1Q3Ctn.js";let C=!1;function X(){C||(C=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{var t;if(!e.defaultPrevented)for(const r of e.target.elements)(t=r.__on_r)==null||t.call(r)})},{capture:!0}))}const E=[...` 	
\r\fÂ \v\uFEFF`];function Z(e,t,r){var a=e==null?"":""+e;if(t&&(a=a?a+" "+t:t),r){for(var o in r)if(r[o])a=a?a+" "+o:o;else if(a.length)for(var s=o.length,n=0;(n=a.indexOf(o,n))>=0;){var l=n+s;(n===0||E.includes(a[n-1]))&&(l===a.length||E.includes(a[l]))?a=(n===0?"":a.substring(0,n))+a.substring(l+1):n=l}}return a===""?null:a}function he(e,t){return e==null?null:String(e)}function x(e,t,r,a,o,s){var n=e.__className;if(_||n!==r||n===void 0){var l=Z(r,a,s);(!_||l!==e.getAttribute("class"))&&(l==null?e.removeAttribute("class"):e.className=l),e.__className=r}else if(s&&o!==s)for(var p in s){var c=!!s[p];(o==null||c!==!!o[p])&&e.classList.toggle(p,c)}return s}const ee=Symbol("is custom element"),te=Symbol("is html");function _e(e){if(_){var t=!1,r=()=>{if(!t){if(t=!0,e.hasAttribute("value")){var a=e.value;N(e,"value",null),e.value=a}if(e.hasAttribute("checked")){var o=e.checked;N(e,"checked",null),e.checked=o}}};e.__on_r=r,B(r),X()}}function ge(e,t){var r=O(e);r.value===(r.value=t??void 0)||e.value===t&&(t!==0||e.nodeName!=="PROGRESS")||(e.value=t??"")}function N(e,t,r,a){var o=O(e);_&&(o[t]=e.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&e.nodeName==="LINK")||o[t]!==(o[t]=r)&&(t==="loading"&&(e[F]=r),r==null?e.removeAttribute(t):typeof r!="string"&&re(e).includes(t)?e[t]=r:e.setAttribute(t,r))}function O(e){return e.__attributes??(e.__attributes={[ee]:e.nodeName.includes("-"),[te]:e.namespaceURI===G})}var L=new Map;function re(e){var t=e.getAttribute("is")||e.nodeName,r=L.get(t);if(r)return r;L.set(t,r=[]);for(var a,o=e,s=Element.prototype;s!==o;){a=z(o);for(var n in a)a[n].set&&r.push(n);o=q(o)}return r}const d=new Map,u=new Map;function ae(e){if(d.has(e))return Promise.resolve(d.get(e));if(u.has(e))return u.get(e);const t=new Promise((r,a)=>{const o=document.createElement("iframe");o.src=e,o.style.display="none",o.style.position="absolute",o.style.left="-9999px",o.style.width="1px",o.style.height="1px",o.onload=()=>{d.set(e,o),u.delete(e),console.log(`Iframe preloaded and cached: ${e}`),r(o)},o.onerror=s=>{u.delete(e),console.error(`Failed to preload iframe: ${e}`,s),a(s)},document.body.appendChild(o),console.log(`Starting iframe preload: ${e}`)});return u.set(e,t),t}function oe(e){return d.get(e)||null}function se(e,t){if(!t)return null;const r=oe(e);if(r){const a=r.cloneNode(!0);return a.style.display="block",a.style.position="static",a.style.left="auto",a.style.width="100%",a.style.height="100%",a.style.border="none",t.innerHTML="",t.appendChild(a),a}return null}function ie(){return{cached:d.size,preloading:u.size,cachedUrls:Array.from(d.keys()),preloadingUrls:Array.from(u.keys())}}function y(e,t={}){if(window.gtag)try{window.gtag("event",e,t)}catch(r){console.error("Error tracking event:",r)}}function ne(e){y("popup_opened",{source_page:e,page_location:window.location.href,page_path:window.location.pathname})}function ve(e){y("conversion",{event_category:"get_started",event_label:"ref_visit",ref_id:e,page_location:window.location.href,custom_parameters:{conversion_type:"ref_visit",campaign_source:"referral"}})}function me(e,t=!1,r=null){y("social_share_click",{social_platform:e,has_ref:t,ref_id:r,page_location:window.location.href,page_path:"/get-started"})}function T(e,t){t(!1),document.body.style.overflow="auto"}var le=e=>e.stopPropagation(),ce=U('<div class="iframe-loading svelte-1lheb99"><p class="svelte-1lheb99">Loading...</p></div>'),fe=U('<div><div class="popup-content svelte-1lheb99"><button class="popup-close svelte-1lheb99">&times;</button> <div class="popup-iframe svelte-1lheb99"><!></div></div></div>');function be(e,t){j(t,!0);let r=M(t,"show",15),a=M(t,"baseUrl",3,"https://act.stand.earth/page/88799/petition/1"),o=P(D(a())),s,n=P(!1);S(()=>{r()&&s&&h(o)&&l()}),S(()=>{if(r()){const i=window.location.pathname;let f="unknown";switch(i){case"/":f="home";break;case"/learn-more":f="learn-more";break;case"/cancel-prime":f="cancel-prime";break;default:f=i.replace("/","")||"home"}ne(f)}});function l(){if(!s)return;se(h(o),s)?(console.log("Using cached iframe for popup"),b(n,!0)):(console.log("Creating fallback iframe for popup"),p())}function p(){if(!s)return;const i=document.createElement("iframe");i.src=h(o),i.title="Join the campaign",i.style.width="100%",i.style.height="100%",i.style.border="none",i.onload=()=>{b(n,!0)},s.innerHTML="",s.appendChild(i)}K(()=>{b(o,`${a()}${window.location.search}`),ae(h(o)).then(()=>{console.log("Popup iframe preloaded successfully")}).catch(i=>{console.error("Failed to preload popup iframe:",i)}),console.log("Iframe cache stats:",ie())});var c=fe();let k;c.__click=[T,r];var g=m(c);g.__click=[le];var I=m(g);I.__click=[T,r];var v=$(I,2),R=m(v);{var H=i=>{var f=ce();A(i,f)};Q(R,i=>{h(n)||i(H)})}w(v),W(v,i=>s=i,()=>s),w(g),w(c),V(i=>k=x(c,1,"popup-overlay svelte-1lheb99",null,k,i),[()=>({show:r()})]),A(e,c),Y()}J(["click"]);export{be as P,x as a,ve as b,ge as c,he as d,_e as r,N as s,me as t};
