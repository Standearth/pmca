import{q as _,aC as G,aD as H,aE as q,aF as z,aG as B,d as D,p as j,g as P,O as J,aa as A,o as K,f as O,c as m,t as V,a as S,b as Y,h as $,i as b,j as h,r as w}from"./CMS7xYzi.js";import"./BoGM1SOC.js";import{p as C,i as Q,b as W}from"./CRni-glT.js";let E=!1;function X(){E||(E=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{var t;if(!e.defaultPrevented)for(const r of e.target.elements)(t=r.__on_r)==null||t.call(r)})},{capture:!0}))}const M=[...` 	
\r\fÂ \v\uFEFF`];function Z(e,t,r){var o=e==null?"":""+e;if(r){for(var a in r)if(r[a])o=o?o+" "+a:a;else if(o.length)for(var s=a.length,n=0;(n=o.indexOf(a,n))>=0;){var l=n+s;(n===0||M.includes(o[n-1]))&&(l===o.length||M.includes(o[l]))?o=(n===0?"":o.substring(0,n))+o.substring(l+1):n=l}}return o===""?null:o}function x(e,t,r,o,a,s){var n=e.__className;if(_||n!==r||n===void 0){var l=Z(r,o,s);(!_||l!==e.getAttribute("class"))&&(l==null?e.removeAttribute("class"):e.className=l),e.__className=r}else if(s&&a!==s)for(var p in s){var c=!!s[p];(a==null||c!==!!a[p])&&e.classList.toggle(p,c)}return s}const ee=Symbol("is custom element"),te=Symbol("is html");function he(e){if(_){var t=!1,r=()=>{if(!t){if(t=!0,e.hasAttribute("value")){var o=e.value;N(e,"value",null),e.value=o}if(e.hasAttribute("checked")){var a=e.checked;N(e,"checked",null),e.checked=a}}};e.__on_r=r,B(r),X()}}function _e(e,t){var r=U(e);r.value===(r.value=t??void 0)||e.value===t&&(t!==0||e.nodeName!=="PROGRESS")||(e.value=t??"")}function N(e,t,r,o){var a=U(e);_&&(a[t]=e.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&e.nodeName==="LINK")||a[t]!==(a[t]=r)&&(t==="loading"&&(e[G]=r),r==null?e.removeAttribute(t):typeof r!="string"&&re(e).includes(t)?e[t]=r:e.setAttribute(t,r))}function U(e){return e.__attributes??(e.__attributes={[ee]:e.nodeName.includes("-"),[te]:e.namespaceURI===H})}var L=new Map;function re(e){var t=e.getAttribute("is")||e.nodeName,r=L.get(t);if(r)return r;L.set(t,r=[]);for(var o,a=e,s=Element.prototype;s!==a;){o=z(a);for(var n in o)o[n].set&&r.push(n);a=q(a)}return r}const u=new Map,d=new Map;function ae(e){if(u.has(e))return Promise.resolve(u.get(e));if(d.has(e))return d.get(e);const t=new Promise((r,o)=>{const a=document.createElement("iframe");a.src=e,a.style.display="none",a.style.position="absolute",a.style.left="-9999px",a.style.width="1px",a.style.height="1px",a.onload=()=>{u.set(e,a),d.delete(e),console.log(`Iframe preloaded and cached: ${e}`),r(a)},a.onerror=s=>{d.delete(e),console.error(`Failed to preload iframe: ${e}`,s),o(s)},document.body.appendChild(a),console.log(`Starting iframe preload: ${e}`)});return d.set(e,t),t}function oe(e){return u.get(e)||null}function se(e,t){if(!t)return null;const r=oe(e);if(r){const o=r.cloneNode(!0);return o.style.display="block",o.style.position="static",o.style.left="auto",o.style.width="100%",o.style.height="100%",o.style.border="none",t.innerHTML="",t.appendChild(o),o}return null}function ie(){return{cached:u.size,preloading:d.size,cachedUrls:Array.from(u.keys()),preloadingUrls:Array.from(d.keys())}}function y(e,t={}){if(window.gtag)try{window.gtag("event",e,t)}catch(r){console.error("Error tracking event:",r)}}function ne(e){y("popup_opened",{source_page:e,page_location:window.location.href,page_path:window.location.pathname})}function ve(e){y("conversion",{event_category:"get_started",event_label:"ref_visit",ref_id:e,page_location:window.location.href,custom_parameters:{conversion_type:"ref_visit",campaign_source:"referral"}})}function ge(e,t=!1,r=null){y("social_share_click",{social_platform:e,has_ref:t,ref_id:r,page_location:window.location.href,page_path:"/get-started"})}function T(e,t){t(!1),document.body.style.overflow="auto"}var le=e=>e.stopPropagation(),ce=O('<div class="iframe-loading svelte-1lheb99"><p class="svelte-1lheb99">Loading...</p></div>'),fe=O('<div><div class="popup-content svelte-1lheb99"><button class="popup-close svelte-1lheb99">&times;</button> <div class="popup-iframe svelte-1lheb99"><!></div></div></div>');function me(e,t){j(t,!0);let r=C(t,"show",15),o=C(t,"baseUrl",3,"https://act.stand.earth/page/88799/petition/1"),a=P(J(o())),s,n=P(!1);A(()=>{r()&&s&&h(a)&&l()}),A(()=>{if(r()){const i=window.location.pathname;let f="unknown";switch(i){case"/":f="home";break;case"/learn-more":f="learn-more";break;case"/cancel-prime":f="cancel-prime";break;default:f=i.replace("/","")||"home"}ne(f)}});function l(){if(!s)return;se(h(a),s)?(console.log("Using cached iframe for popup"),b(n,!0)):(console.log("Creating fallback iframe for popup"),p())}function p(){if(!s)return;const i=document.createElement("iframe");i.src=h(a),i.title="Join the campaign",i.style.width="100%",i.style.height="100%",i.style.border="none",i.onload=()=>{b(n,!0)},s.innerHTML="",s.appendChild(i)}K(()=>{b(a,`${o()}${window.location.search}`),ae(h(a)).then(()=>{console.log("Popup iframe preloaded successfully")}).catch(i=>{console.error("Failed to preload popup iframe:",i)}),console.log("Iframe cache stats:",ie())});var c=fe();let k;c.__click=[T,r];var v=m(c);v.__click=[le];var I=m(v);I.__click=[T,r];var g=$(I,2),R=m(g);{var F=i=>{var f=ce();S(i,f)};Q(R,i=>{h(n)||i(F)})}w(g),W(g,i=>s=i,()=>s),w(v),w(c),V(i=>k=x(c,1,"popup-overlay svelte-1lheb99",null,k,i),[()=>({show:r()})]),S(e,c),Y()}D(["click"]);export{me as P,x as a,ve as b,_e as c,he as r,N as s,ge as t};
