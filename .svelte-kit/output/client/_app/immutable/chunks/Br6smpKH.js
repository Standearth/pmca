import{q as h,af as R,ag as H,ah as F,ai as j,aj as q,d as z,p as G,g as I,O as B,aa as D,o as J,f as C,c as m,t as K,a as A,b as V,h as Y,i as _,j as p,r as b}from"./CTSxgTlG.js";import"./BX8KHRNg.js";import{p as M,i as $,b as Q}from"./DWzhdOWU.js";let P=!1;function W(){P||(P=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{var t;if(!e.defaultPrevented)for(const r of e.target.elements)(t=r.__on_r)==null||t.call(r)})},{capture:!0}))}const N=[...` 	
\r\fÂ \v\uFEFF`];function X(e,t,r){var o=e==null?"":""+e;if(r){for(var a in r)if(r[a])o=o?o+" "+a:a;else if(o.length)for(var s=a.length,i=0;(i=o.indexOf(a,i))>=0;){var n=i+s;(i===0||N.includes(o[i-1]))&&(n===o.length||N.includes(o[n]))?o=(i===0?"":o.substring(0,i))+o.substring(n+1):i=n}}return o===""?null:o}function Z(e,t,r,o,a,s){var i=e.__className;if(h||i!==r||i===void 0){var n=X(r,o,s);(!h||n!==e.getAttribute("class"))&&(n==null?e.removeAttribute("class"):e.className=n),e.__className=r}else if(s&&a!==s)for(var u in s){var f=!!s[u];(a==null||f!==!!a[u])&&e.classList.toggle(u,f)}return s}const x=Symbol("is custom element"),ee=Symbol("is html");function ue(e){if(h){var t=!1,r=()=>{if(!t){if(t=!0,e.hasAttribute("value")){var o=e.value;S(e,"value",null),e.value=o}if(e.hasAttribute("checked")){var a=e.checked;S(e,"checked",null),e.checked=a}}};e.__on_r=r,q(r),W()}}function pe(e,t){var r=E(e);r.value===(r.value=t??void 0)||e.value===t&&(t!==0||e.nodeName!=="PROGRESS")||(e.value=t??"")}function S(e,t,r,o){var a=E(e);h&&(a[t]=e.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&e.nodeName==="LINK")||a[t]!==(a[t]=r)&&(t==="loading"&&(e[R]=r),r==null?e.removeAttribute(t):typeof r!="string"&&te(e).includes(t)?e[t]=r:e.setAttribute(t,r))}function E(e){return e.__attributes??(e.__attributes={[x]:e.nodeName.includes("-"),[ee]:e.namespaceURI===H})}var k=new Map;function te(e){var t=e.getAttribute("is")||e.nodeName,r=k.get(t);if(r)return r;k.set(t,r=[]);for(var o,a=e,s=Element.prototype;s!==a;){o=j(a);for(var i in o)o[i].set&&r.push(i);a=F(a)}return r}const d=new Map,c=new Map;function re(e){if(d.has(e))return Promise.resolve(d.get(e));if(c.has(e))return c.get(e);const t=new Promise((r,o)=>{const a=document.createElement("iframe");a.src=e,a.style.display="none",a.style.position="absolute",a.style.left="-9999px",a.style.width="1px",a.style.height="1px",a.onload=()=>{d.set(e,a),c.delete(e),console.log(`Iframe preloaded and cached: ${e}`),r(a)},a.onerror=s=>{c.delete(e),console.error(`Failed to preload iframe: ${e}`,s),o(s)},document.body.appendChild(a),console.log(`Starting iframe preload: ${e}`)});return c.set(e,t),t}function ae(e){return d.get(e)||null}function oe(e,t){if(!t)return null;const r=ae(e);if(r){const o=r.cloneNode(!0);return o.style.display="block",o.style.position="static",o.style.left="auto",o.style.width="100%",o.style.height="100%",o.style.border="none",t.innerHTML="",t.appendChild(o),o}return null}function se(){return{cached:d.size,preloading:c.size,cachedUrls:Array.from(d.keys()),preloadingUrls:Array.from(c.keys())}}function L(e,t){t(!1),document.body.style.overflow="auto"}var ie=e=>e.stopPropagation(),le=C('<div class="iframe-loading svelte-1lheb99"><p class="svelte-1lheb99">Loading...</p></div>'),ne=C('<div><div class="popup-content svelte-1lheb99"><button class="popup-close svelte-1lheb99">&times;</button> <div class="popup-iframe svelte-1lheb99"><!></div></div></div>');function he(e,t){G(t,!0);let r=M(t,"show",15),o=M(t,"baseUrl",3,"https://act.stand.earth/page/88799/petition/1"),a=I(B(o())),s,i=I(!1);D(()=>{r()&&s&&p(a)&&n()});function n(){if(!s)return;oe(p(a),s)?(console.log("Using cached iframe for popup"),_(i,!0)):(console.log("Creating fallback iframe for popup"),u())}function u(){if(!s)return;const l=document.createElement("iframe");l.src=p(a),l.title="Join the campaign",l.style.width="100%",l.style.height="100%",l.style.border="none",l.onload=()=>{_(i,!0)},s.innerHTML="",s.appendChild(l)}J(()=>{_(a,`${o()}${window.location.search}`),re(p(a)).then(()=>{console.log("Popup iframe preloaded successfully")}).catch(l=>{console.error("Failed to preload popup iframe:",l)}),console.log("Iframe cache stats:",se())});var f=ne();let y;f.__click=[L,r];var v=m(f);v.__click=[ie];var w=m(v);w.__click=[L,r];var g=Y(w,2),T=m(g);{var U=l=>{var O=le();A(l,O)};$(T,l=>{p(i)||l(U)})}b(g),Q(g,l=>s=l,()=>s),b(v),b(f),K(l=>y=Z(f,1,"popup-overlay svelte-1lheb99",null,y,l),[()=>({show:r()})]),A(e,f),V()}z(["click"]);export{he as P,Z as a,pe as b,ue as r,S as s};
